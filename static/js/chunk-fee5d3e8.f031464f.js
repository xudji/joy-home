(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-fee5d3e8"],{"0c6d":function(e,t,r){"use strict";r("d3b7");var l=r("bc3a"),a=r.n(l),n=r("5c96"),o=r("4360"),s=r("2f4d"),i=void 0,m=a.a.create({baseURL:"http://leju.bufan.cloud",timeout:5e3});m.interceptors.request.use((function(e){return Object(s["a"])()&&(e.headers["token"]=Object(s["a"])()),e}),(function(e){return console.log(e),Promise.reject(e)})),m.interceptors.response.use((function(e){var t=e.data;return 2e4!==t.code?(Object(n["Message"])({message:t.message||"Error",type:"error",duration:5e3}),20002===t.code&&(Object(s["c"])(),Object(s["d"])(),i.$router.push("/login")),50008!==t.code&&50012!==t.code&&50014!==t.code||n["MessageBox"].confirm("You have been logged out, you can cancel to stay on this page, or log in again","Confirm logout",{confirmButtonText:"Re-Login",cancelButtonText:"Cancel",type:"warning"}).then((function(){o["a"].dispatch("user/resetToken").then((function(){location.reload()}))})),Promise.reject(new Error(t.message||"Error"))):t}),(function(e){return console.log("err"+e),Object(n["Message"])({message:e.message,type:"error",duration:5e3}),Promise.reject(e)})),t["a"]=m},1769:function(e,t,r){},"21b5":function(e,t,r){"use strict";r.r(t);var l=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"auth-source-main"},[r("el-card",{staticClass:"margin-30",attrs:{shadow:"never"}},[r("div",{attrs:{slot:"header"},slot:"header"},[r("el-button",{attrs:{type:"warning",size:"mini"},on:{click:e.goInitMenus}},[e._v("初始化菜单")]),r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.goAddMenu}},[e._v("新增菜单")])],1),r("el-table",{attrs:{data:e.menuList,border:"",stripe:"","row-key":"id","header-cell-style":{"text-align":"center"},"cell-style":{"text-align":"center"},"tree-props":{children:"children",hasChildren:"hasChildren"}}},[r("el-table-column",{attrs:{label:"菜单名称",width:"200",fixed:""},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.title))]),t.row.hidden?r("svg-icon",{attrs:{title:"隐藏,不可见","icon-class":"hidden","class-name":"custom-class"}}):e._e()]}}])}),r("el-table-column",{attrs:{label:"图标"},scopedSlots:e._u([{key:"default",fn:function(e){return[r("i",{class:e.row.icon})]}}])}),r("el-table-column",{attrs:{label:"等级",prop:"level"}}),r("el-table-column",{attrs:{label:"排序",prop:"sort"}}),r("el-table-column",{attrs:{label:"权限标识",prop:"permissionValue"}}),r("el-table-column",{attrs:{label:"路由",prop:"path"}}),r("el-table-column",{attrs:{label:"组件路径",prop:"component"}}),r("el-table-column",{attrs:{label:"是否可用",prop:"status"}}),r("el-table-column",{attrs:{label:"创建时间",prop:"createTime"}})],1)],1),r("el-card",{staticClass:"margin-30",attrs:{shadow:"never"}},[r("el-cascader",{attrs:{options:e.formatList,props:{checkStrictly:!0,label:"title",value:"id",emitPath:!1},clearable:""},model:{value:e.pid,callback:function(t){e.pid=t},expression:"pid"}})],1),r("MenuTree",{ref:"menuTree",on:{refresh:e.findAllPermissions}}),r("MenuForm",{ref:"menuForm",attrs:{options:e.menuList}})],1)},a=[],n=r("b6df"),o=r("2ef0"),s=r.n(o),i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"menu-form"},[r("el-dialog",{attrs:{title:"编辑菜单",visible:e.dialog,width:"50%"},on:{"update:visible":function(t){e.dialog=t},close:e.handleClose}},[r("div",{staticStyle:{"margin-bottom":"22px"}},[r("label",{staticStyle:{width:"80px","padding-right":"12px"}},[e._v("菜单类型 ")]),r("el-radio-group",{model:{value:e.menuType,callback:function(t){e.menuType=t},expression:"menuType"}},[r("el-radio",{key:"1",attrs:{label:1}},[e._v("顶级目录")]),r("el-radio",{key:"2",attrs:{label:2}},[e._v("菜单")]),r("el-radio",{key:"3",attrs:{label:3}},[e._v("按钮")])],1)],1),1===e.menuType?r("TopMenuForm",{key:"1",ref:"form_tab1"}):e._e(),2===e.menuType?r("NormalMenuForm",{key:"2",ref:"form_tab2",attrs:{"menu-options":e.optionsCom}}):e._e(),3===e.menuType?r("BtnMenuForm",{key:"3",ref:"form_tab3",attrs:{"menu-options":e.optionsCom}}):e._e(),r("span",{attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{size:"small"},on:{click:e.handleClose}},[e._v("取消")]),r("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.doSave}},[e._v("确定")])],1)],1)],1)},m=[],u=(r("4e82"),r("e9c4"),r("4de4"),r("d3b7"),r("0c6d"));function c(e){return Object(u["a"])({url:"/admin/sysAuth/permission/findAllPermissions",method:"GET",data:e})}function d(e){return Object(u["a"])({url:"/admin/sysAuth/permission/remove/".concat(e),method:"DELETE"})}function f(e){return Object(u["a"])({url:"/admin/sysAuth/permission/save",method:"POST",data:e})}function p(e){return Object(u["a"])({url:"/admin/sysAuth/permission/saveInitMenus",method:"POST",data:e})}function h(e){return Object(u["a"])({url:"/admin/sysAuth/permission/update",method:"PUT",data:e})}function b(e){return Object(u["a"])({url:"/admin/sysAuth/permission/saveRolePermission",method:"POST",data:e})}function g(e){return Object(u["a"])({url:"/admin/sysAuth/permission/selectAllMenu/".concat(e),method:"GET"})}var v={findAllPermissions:c,removePermission:d,savePermission:f,updatePermission:h,saveRolePermission:b,selectAllMenu:g,saveInitMenus:p},y=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"top-menu-form"},[r("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"80px",inline:!1,size:"normal"}},[r("el-form-item",{attrs:{label:"路由名称",prop:"name"}},[r("el-input",{attrs:{size:"small",rules:e.rules.name,placeholder:"前端路由name,唯一"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),r("el-form-item",{attrs:{label:"路径",prop:"path"}},[r("el-input",{attrs:{size:"small",rules:e.rules.path,placeholder:"前端路由path,忽略父节点路径"},model:{value:e.form.path,callback:function(t){e.$set(e.form,"path",t)},expression:"form.path"}})],1),r("el-form-item",{attrs:{label:"组建路径",prop:"component"}},[r("el-input",{attrs:{rules:e.rules.component,size:"small",placeholder:"前端路由组件路径,比如@/views/foo/foo.vue"},model:{value:e.form.component,callback:function(t){e.$set(e.form,"component",t)},expression:"form.component"}})],1),r("el-form-item",{attrs:{label:"重定向"}},[r("el-input",{attrs:{size:"small",placeholder:"redirect属性"},model:{value:e.form.redirect,callback:function(t){e.$set(e.form,"redirect",e._n(t))},expression:"form.redirect"}})],1),r("el-form-item",{attrs:{label:"排序"}},[r("el-input-number",{attrs:{size:"small",placeholder:"排序:值越大,越靠前"},model:{value:e.form.sort,callback:function(t){e.$set(e.form,"sort",e._n(t))},expression:"form.sort"}})],1),r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:12,offset:0}},[r("el-form-item",{attrs:{label:"是否隐藏"}},[r("el-radio-group",{model:{value:e.form.hidden,callback:function(t){e.$set(e.form,"hidden",t)},expression:"form.hidden"}},[r("el-radio",{attrs:{label:!0}},[e._v(" 否 ")]),r("el-radio",{attrs:{label:!1}},[e._v(" 是 ")])],1)],1)],1),r("el-col",{attrs:{span:12,offset:0}},[r("el-form-item",{attrs:{label:"是否展开"}},[r("el-radio-group",{model:{value:e.form.alwaysShow,callback:function(t){e.$set(e.form,"alwaysShow",t)},expression:"form.alwaysShow"}},[r("el-radio",{attrs:{label:!1}},[e._v(" 否 ")]),r("el-radio",{attrs:{label:!0}},[e._v(" 是 ")])],1)],1)],1)],1),r("el-form-item",{attrs:{label:"meta属性",size:"normal"}},e._l(e.metaList,(function(t){return r("el-row",{key:t.tempId,staticStyle:{"margin-left":"0"},attrs:{gutter:30}},[r("el-col",{staticStyle:{"padding-left":"0"},attrs:{span:9}},[r("el-input",{attrs:{placeholder:"meta的key",size:"mini",clearable:""},model:{value:t.key,callback:function(r){e.$set(t,"key",r)},expression:"meta.key"}})],1),r("el-col",{attrs:{span:9,offset:0}},[r("el-input",{attrs:{placeholder:t.placeholder,size:"mini",clearable:""},model:{value:t.value,callback:function(r){e.$set(t,"value",r)},expression:"meta.value"}})],1),r("el-col",{attrs:{span:6,offset:0}},[r("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-plus"},on:{click:e.createMetaItem}}),t.hiddenDel?e._e():r("el-button",{staticStyle:{color:"red"},attrs:{type:"text",size:"mini",icon:"el-icon-minus"},on:{click:function(r){return e.removeMetaItem(t.tempId)}}})],1)],1)})),1)],1)],1)},k=[],T=r("5530"),x=(r("159b"),{name:"TopMenuForm",data:function(){return{metaList:[{key:"title",value:"未命名",placeholder:"比如商品管理",hiddenDel:!0},{key:"icon",value:"el-icon-menu",placeholder:"比如 el-icon-menu",hiddenDel:!0}],form:{pid:"0",type:1,level:0,hidden:!1,alwaysShow:!1,sort:0,meta:{}},rules:{title:[{required:!0,message:"标题不能为空",trigger:"blur"}],name:[{required:!0,message:"name不能为空",trigger:"blur"}],path:[{required:!0,message:"路径不能为空",trigger:"blur"}],component:[{required:!0,message:"组建不能为空",trigger:"blur"}]}}},computed:{},methods:{createMetaItem:function(){this.metaList.push({tempId:(new Date).getTime(),key:"",value:""})},removeMetaItem:function(e){this.metaList=this.metaList.filter((function(t){return t.tempId!=e}))},formatSubmitData:function(){var e=this;this.metaList.forEach((function(t){e.form.meta[t.key]=t.value}));var t=this.form.meta,r=t.icon,l=t.title;return this.form.meta=JSON.stringify(this.form.meta),Object(T["a"])(Object(T["a"])({},this.form),{},{icon:r,title:l})}}}),_=x,w=r("2877"),M=Object(w["a"])(_,y,k,!1,null,null,null),$=M.exports,O=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"normal-menu-form"},[r("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"80px",inline:!1,size:"normal"}},[r("el-form-item",{attrs:{label:"上级菜单",prop:"pid"}},[r("el-cascader",{ref:"menuTree",attrs:{options:e.menuOptions,size:"small",props:{expandTrigger:"hover",emitPath:!1,checkStrictly:!0,label:"title",value:"id"},clearable:""},on:{change:e.menuTreeChange},model:{value:e.form.pid,callback:function(t){e.$set(e.form,"pid",t)},expression:"form.pid"}})],1),r("el-form-item",{attrs:{label:"路由名称",prop:"name"}},[r("el-input",{attrs:{size:"small",rules:e.rules.name,placeholder:"前端路由name,唯一"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),r("el-form-item",{attrs:{label:"路径",prop:"path"}},[r("el-input",{attrs:{size:"small",rules:e.rules.path,placeholder:"前端路由path,忽略父节点路径"},model:{value:e.form.path,callback:function(t){e.$set(e.form,"path",t)},expression:"form.path"}})],1),r("el-form-item",{attrs:{label:"组建路径",prop:"component"}},[r("el-input",{attrs:{rules:e.rules.component,size:"small",placeholder:"前端路由组件路径,比如@/views/foo/foo.vue"},model:{value:e.form.component,callback:function(t){e.$set(e.form,"component",t)},expression:"form.component"}})],1),r("el-form-item",{attrs:{label:"重定向"}},[r("el-input",{attrs:{size:"small",placeholder:"redirect属性"},model:{value:e.form.redirect,callback:function(t){e.$set(e.form,"redirect",e._n(t))},expression:"form.redirect"}})],1),r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:12,offset:0}},[r("el-form-item",{attrs:{label:"排序"}},[r("el-input-number",{attrs:{size:"small",placeholder:"排序:值越大,越靠前"},model:{value:e.form.sort,callback:function(t){e.$set(e.form,"sort",e._n(t))},expression:"form.sort"}})],1)],1),r("el-col",{attrs:{span:12,offset:0}},[r("el-form-item",{attrs:{label:"层级"}},[r("el-input-number",{attrs:{size:"small",placeholder:"层级"},model:{value:e.form.level,callback:function(t){e.$set(e.form,"level",e._n(t))},expression:"form.level"}})],1)],1)],1),r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:12,offset:0}},[r("el-form-item",{attrs:{label:"是否隐藏"}},[r("el-radio-group",{model:{value:e.form.hidden,callback:function(t){e.$set(e.form,"hidden",t)},expression:"form.hidden"}},[r("el-radio",{attrs:{label:!0}},[e._v(" 否 ")]),r("el-radio",{attrs:{label:!1}},[e._v(" 是 ")])],1)],1)],1),r("el-col",{attrs:{span:12,offset:0}},[r("el-form-item",{attrs:{label:"是否展开"}},[r("el-radio-group",{model:{value:e.form.alwaysShow,callback:function(t){e.$set(e.form,"alwaysShow",t)},expression:"form.alwaysShow"}},[r("el-radio",{attrs:{label:!1}},[e._v(" 否 ")]),r("el-radio",{attrs:{label:!0}},[e._v(" 是 ")])],1)],1)],1)],1),r("el-form-item",{attrs:{label:"meta属性",size:"normal"}},e._l(e.metaList,(function(t){return r("el-row",{key:t.tempId,staticStyle:{"margin-left":"0"},attrs:{gutter:30}},[r("el-col",{staticStyle:{"padding-left":"0"},attrs:{span:9}},[r("el-input",{attrs:{placeholder:"比如: title",size:"mini",clearable:""},model:{value:t.key,callback:function(r){e.$set(t,"key",r)},expression:"meta.key"}})],1),r("el-col",{attrs:{span:9,offset:0}},[r("el-input",{attrs:{placeholder:"比如: 商品管理",size:"mini",clearable:""},model:{value:t.value,callback:function(r){e.$set(t,"value",r)},expression:"meta.value"}})],1),r("el-col",{attrs:{span:6,offset:0}},[r("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-plus"},on:{click:e.createMetaItem}}),r("el-button",{staticStyle:{color:"red"},attrs:{type:"text",size:"mini",icon:"el-icon-minus"},on:{click:function(r){return e.removeMetaItem(t.tempId)}}})],1)],1)})),1)],1)],1)},S=[],j={name:"NormalMenuForm",props:{menuOptions:{type:Array,required:!0}},data:function(){return{metaList:[{key:"title",value:"未命名",placeholder:"比如商品管理",hiddenDel:!0},{key:"icon",value:"el-icon-menu",placeholder:"比如 el-icon-menu",hiddenDel:!0}],form:{pid:"",type:1,level:1,hidden:!1,alwaysShow:!1,sort:0,meta:{}},rules:{pid:[{required:!0,message:"页面id不能为空",trigger:"blur"}],title:[{required:!0,message:"标题不能为空",trigger:"blur"}],name:[{required:!0,message:"name不能为空",trigger:"blur"}],path:[{required:!0,message:"路径不能为空",trigger:"blur"}],component:[{required:!0,message:"组建不能为空",trigger:"blur"}]}}},computed:{},methods:{createMetaItem:function(){this.metaList.push({tempId:(new Date).getTime(),key:"",value:""})},removeMetaItem:function(e){this.metaList=this.metaList.filter((function(t){return t.tempId!=e}))},menuTreeChange:function(e){console.log(e)},formatSubmitData:function(){var e=this;this.metaList.forEach((function(t){e.form.meta[t.key]=t.value}));var t=this.form.meta,r=t.icon,l=t.title;return this.form.meta=JSON.stringify(this.form.meta),Object(T["a"])(Object(T["a"])({},this.form),{},{icon:r,title:l})}}},z=j,I=Object(w["a"])(z,O,S,!1,null,null,null),L=I.exports,P=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"80px",inline:!1,size:"normal"}},[r("el-form-item",{attrs:{label:"所在页面",prop:"pid"}},[r("el-cascader",{ref:"menuTree",attrs:{options:e.menuOptions,size:"small",props:{expandTrigger:"hover",emitPath:!1,checkStrictly:!0,label:"title",value:"id"},clearable:""},on:{change:e.menuTreeChange},model:{value:e.form.pid,callback:function(t){e.$set(e.form,"pid",t)},expression:"form.pid"}})],1),r("el-form-item",{attrs:{label:"按钮名称",prop:"title"}},[r("el-input",{attrs:{size:"small",placeholder:"按钮名称,比如: 新增"},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:12,offset:0}},[r("el-form-item",{attrs:{label:"排序"}},[r("el-input-number",{attrs:{size:"small",placeholder:"排序:值越大,越靠前"},model:{value:e.form.sort,callback:function(t){e.$set(e.form,"sort",e._n(t))},expression:"form.sort"}})],1)],1),r("el-col",{attrs:{span:12,offset:0}},[r("el-form-item",{attrs:{label:"层级"}},[r("el-input-number",{attrs:{size:"small",placeholder:"层级"},model:{value:e.form.level,callback:function(t){e.$set(e.form,"level",e._n(t))},expression:"form.level"}})],1)],1)],1),r("el-form-item",{attrs:{prop:"permissionValue",label:"权限标识",size:"normal"}},[r("el-input",{attrs:{type:"textarea",placeholder:"按钮权限标识,比如: productList.list",size:"normal",clearable:""},model:{value:e.form.permissionValue,callback:function(t){e.$set(e.form,"permissionValue",t)},expression:"form.permissionValue"}})],1)],1)},A=[],C={name:"BtnMenuForm",props:{menuOptions:{type:Array,required:!0}},data:function(){return{form:{pid:"",type:2,sort:0,level:0},rules:{pid:[{required:!0,message:"页面id不能为空",trigger:"blur"}],title:[{required:!0,message:"标题不能为空",trigger:"blur"}],permissionValue:[{required:!0,message:"权限标识不能为空",trigger:"blur"}]}}},methods:{removeMetaItem:function(e){this.metaList=this.metaList.filter((function(t){return t.tempId!=e}))},menuTreeChange:function(e){console.log(e)},formatSubmitData:function(){return Object(T["a"])({},this.form)}}},D=C,q=Object(w["a"])(D,P,A,!1,null,null,null),E=q.exports,B={name:"MenuForm",components:{TopMenuForm:$,NormalMenuForm:L,BtnMenuForm:E},props:{options:{type:Array,required:!0}},data:function(){return{dialog:!1,menuType:1,menu:{sort:0},menuTree:[],metaList:[{key:"title",value:"未命名"}],rules:{title:[{required:!0,message:"标题不能为空",trigger:"blur"}],name:[{required:!0,message:"name不能为空",trigger:"blur"}],path:[{required:!0,message:"路径不能为空",trigger:"blur"}],component:[{required:!0,message:"组建不能为空",trigger:"blur"}],permissionValue:[{required:!0,message:"权限标识不能为空",trigger:"blur"}]}}},computed:{optionsCom:function(){var e=s.a.cloneDeep(this.options);return this.rebuildMenuTree(e),e}},created:function(){},methods:{openDialog:function(){this.dialog=!0},handleClose:function(){this.dialog=!1},doSave:function(){var e=this,t=this.$refs["form_tab".concat(this.menuType)],r=t.$refs.form;r.validate((function(r){if(r){var l=t.formatSubmitData();v.savePermission(l).then((function(t){t.success?e.$message.success("保存成功!"):e.$message.error(t.message)}))}else e.$message.error("请注意表单验证!")}))},doSave2:function(){var e=this;this.$refs.form.validate((function(t){if(!t)return e.$message.error("请注意表单验证!"),!1;var r={};if(1===e.menuType)Object.assign(e.menu,r),e.menu.pId="0",delete r.title,delete r.permissionValue;else if(2===e.menuType){var l=e.$refs.menuTree.getCheckedNodes();if(l&&l.length>0&&(r.pId=l[0].value,r.level=l[0].level+1,console.log(l)),!e.menu.pId)return void e.$message.error("父类菜单必选!");Object.assign(e.menu,r),delete r.title,delete r.permissionValue}else r={type:2,pId:e.menu.pId,title:e.menu.title,sort:e.menu.sort,permissionValue:e.menu.permissionValue};if(3!=e.menuType){r.type=1;for(var a=0;a<e.metaList.length;a++){var n=e.metaList[a];(n.key||n.value)&&(r.meta||(r.meta={}),r.meta[n.key]=n.value)}r.meta&&(r.title=r.meta.title,r.meta=JSON.stringify(r.meta))}console.log(r),v.savePermission(r).then((function(t){t.success?e.$message.success("保存成功!"):e.$message.error(t.message)}))}))},menuTreeChange:function(e){console.log(e)},rebuildMenuTree:function(e){for(var t=0;t<e.length;t++){var r=e[t];2==r.type&&(r.disabled=!0),r.children&&0==r.children.length?delete r.children:this.rebuildMenuTree(r.children)}},createMetaItem:function(){this.metaList.push({tempId:(new Date).getTime(),key:"",value:""})},removeMetaItem:function(e){this.metaList=this.metaList.filter((function(t){return t.tempId!=e}))}}},F=B,R=Object(w["a"])(F,i,m,!1,null,"09a06d44",null),V=R.exports,N=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"menu-tree"},[r("el-dialog",{attrs:{title:"初始化的菜单列表",visible:e.dialog,width:"40%"},on:{"update:visible":function(t){e.dialog=t},close:e.handleClose}},[r("el-alert",{attrs:{title:"请谨慎操作! 初始化菜单会覆盖之前记录!",type:"warning"}}),r("el-tree",{ref:"tree",staticStyle:{"margin-top":"30px"},attrs:{data:e.menuTree,"node-key":"id",props:e.defaultProps}}),r("span",{attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:e.handleClose}},[e._v("取消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.doSaveInitMenus}},[e._v("保存")])],1)],1)],1)},J=[],U=(r("fb6a"),r("b0c0"),r("a18c")),G={name:"MenuTree",data:function(){return{constantRoutes:U["a"],dialog:!1,defaultProps:{children:"children",label:"label"},menuTree:[]}},computed:{},created:function(){var e=s.a.cloneDeep(this.constantRoutes);e=this.arrayTrim(e,1,3),console.log(e),this.reBuildMenuTree(e),this.menuTree=e},methods:{arrayTrim:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return r=-r,e.slice(t,r)},openDialog:function(){this.dialog=!0},handleClose:function(){this.dialog=!1},doSaveInitMenus:function(){var e=this,t=s.a.cloneDeep(this.constantRoutes);t=this.arrayTrim(t,1,3);var r=this.reBuildMenuData(t);v.saveInitMenus(r).then((function(t){t.success?(e.$message.success("保存成功!"),e.handleClose(),e.$emit("refresh")):e.$message.error(t.message)}))},reBuildMenuData:function(e){for(var t=0;t<e.length;t++){var r=e[t];r.meta&&(r.label=r.meta.title,r.component=r.meta.componentUrl,r.title=r.meta.title,r.icon=r.meta.icon,r.meta=JSON.stringify(r.meta),r.children&&r.children.length>0&&this.reBuildMenuData(r.children))}return e},reBuildMenuTree:function(e){for(var t=0;t<e.length;t++){var r=e[t];r.id=r.name,r.meta&&(r.label=r.meta.title,r.component=r.meta.componentUrl,r.children&&r.children.length>0?this.reBuildMenuTree(r.children):r.children=[{id:r.id+".list",label:"查询"},{id:r.id+".add",label:"新增"},{id:r.id+".edit",label:"编辑"},{id:r.id+".del",label:"删除"}])}}}},Y=G,H=Object(w["a"])(Y,N,J,!1,null,"fb919b8a",null),K=H.exports,Q={name:"Source",data:function(){return{menuList:[],pid:"",loading:!1,dialog:!1}},components:{MenuForm:V,MenuTree:K},computed:{formatList:function(){var e=o["cloneDeep"](this.menuList);return this.reBuildDeepList(e),e}},created:function(){console.log(this.findAllPermissions())},methods:{goInitMenus:function(){this.$refs.menuTree.openDialog()},goAddMenu:function(){this.$refs.menuForm.openDialog()},reBuildDeepList:function(e){for(var t=0;t<e.length;t++){var r=e[t];2===r.type&&(r.disabled=!0),r.children&&r.children.length>0?this.reBuildDeepList(r.children):delete r.children}},findAllPermissions:function(){var e=this;this.loading=!0,Object(n["b"])().then((function(t){var r=t.success,l=t.data,a=t.message;r?e.menuList=l.menus:e.$message.error(a),e.loading=!1}))}}},W=Q,X=(r("28cb"),Object(w["a"])(W,l,a,!1,null,"9ac573c8",null));t["default"]=X.exports},"28cb":function(e,t,r){"use strict";r("1769")},"4e82":function(e,t,r){"use strict";var l=r("23e7"),a=r("1c0b"),n=r("7b0b"),o=r("d039"),s=r("a640"),i=[],m=i.sort,u=o((function(){i.sort(void 0)})),c=o((function(){i.sort(null)})),d=s("sort"),f=u||!c||!d;l({target:"Array",proto:!0,forced:f},{sort:function(e){return void 0===e?m.call(n(this)):m.call(n(this),a(e))}})},b6df:function(e,t,r){"use strict";r.d(t,"b",(function(){return a})),r.d(t,"d",(function(){return n})),r.d(t,"f",(function(){return o})),r.d(t,"g",(function(){return s})),r.d(t,"c",(function(){return i})),r.d(t,"e",(function(){return m}));r("99af");var l=r("0c6d");function a(){return Object(l["a"])({url:"/admin/sysAuth/permission/findAllPermissions",method:"get"})}function n(e,t,r){return Object(l["a"])({url:"/admin/sysAuth/role/findRolesByPage/".concat(e,"/").concat(t),method:"get",data:r})}function o(e){return Object(l["a"])({url:"/admin/sysAuth/role/removeRole/".concat(e),method:"delete"})}function s(e){return Object(l["a"])({url:"/admin/sysAuth/role/saveRolePermissions",method:"POST",data:e})}function i(){return Object(l["a"])({url:"/admin/sysAuth/role/findAllRoles",method:"GET"})}function m(e){return Object(l["a"])({url:"/admin/sysAuth/role/findRolePermissions/".concat(e),method:"get"})}}}]);