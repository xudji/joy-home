(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-62a41686"],{"0512":function(t,e,a){},"0c6d":function(t,e,a){"use strict";a("d3b7");var s=a("bc3a"),i=a.n(s),r=a("5c96"),n=a("4360"),o=a("2f4d"),l=void 0,c=i.a.create({baseURL:"http://leju.bufan.cloud",timeout:5e3});c.interceptors.request.use((function(t){return Object(o["a"])()&&(t.headers["token"]=Object(o["a"])()),t}),(function(t){return console.log(t),Promise.reject(t)})),c.interceptors.response.use((function(t){var e=t.data;return 2e4!==e.code?(Object(r["Message"])({message:e.message||"Error",type:"error",duration:5e3}),20002===e.code&&(Object(o["c"])(),Object(o["d"])(),l.$router.push("/login")),50008!==e.code&&50012!==e.code&&50014!==e.code||r["MessageBox"].confirm("You have been logged out, you can cancel to stay on this page, or log in again","Confirm logout",{confirmButtonText:"Re-Login",cancelButtonText:"Cancel",type:"warning"}).then((function(){n["a"].dispatch("user/resetToken").then((function(){location.reload()}))})),Promise.reject(new Error(e.message||"Error"))):e}),(function(t){return console.log("err"+t),Object(r["Message"])({message:t.message,type:"error",duration:5e3}),Promise.reject(t)})),e["a"]=c},1539:function(t,e,a){"use strict";a("7512")},"1b62":function(t,e,a){"use strict";var s=a("2f4d");e["a"]={data:function(){return{uploadFileOss:"/lejuAdmin/material/uploadFileOssSave",uploadUrl1:"/lejuAdmin/material/uploadFileOss",uploadUrl:"/lejuAdmin/material/uploadFileOssSave",uploadHeaders:{token:Object(s["a"])()},pagniationParams:{start:1,limit:10,totalNum:0,pageSizes:[10,20,30,40]},loadingOption:{background:"rgba(255,255,255,.9)",text:"loading.....",spinner:"el-icon-loading"}}},computed:{token:function(){return{token:Object(s["a"])()}}}}},2332:function(t,e,a){"use strict";a("67f6")},"41e5":function(t,e,a){"use strict";a("0512")},"67f6":function(t,e,a){},7512:function(t,e,a){},"782b":function(t,e,a){"use strict";a.d(e,"a",(function(){return r})),a.d(e,"f",(function(){return l})),a.d(e,"g",(function(){return c})),a.d(e,"d",(function(){return o})),a.d(e,"c",(function(){return n})),a.d(e,"e",(function(){return i})),a.d(e,"b",(function(){return u}));a("99af");var s=a("0c6d");function i(){return Object(s["a"])({url:"/lejuAdmin/brand/findAllBrand",method:"get"})}function r(t){return Object(s["a"])({url:"/lejuAdmin/brand/addBrand",method:"post",data:t})}function n(t,e){return Object(s["a"])({url:"/lejuAdmin/brand/findBrandByPage/".concat(t,"/").concat(e),method:"get"})}function o(t){return Object(s["a"])({url:"/lejuAdmin/brand/delBrand/".concat(t),method:"delete"})}function l(t){return Object(s["a"])({url:"/lejuAdmin/brand/switchShowStatus",method:"post",data:t})}function c(t){return Object(s["a"])({url:"/lejuAdmin/brand/updateBrand",method:"post",data:t})}function u(){return Object(s["a"])({url:"/lejuAdmin/brand/findAllBrand",method:"get"})}},8256:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"tinymce-container",class:{fullscreen:t.fullscreen},style:{width:t.containerWidth}},[a("textarea",{staticClass:"tinymce-textarea",attrs:{id:t.tinymceId}}),t._v(" "),a("div",{staticClass:"editor-custom-btn-container"},[a("el-button",{staticClass:"btn",attrs:{type:"primary",size:"mini",icon:"el-icon-upload"}},[t._v(" 上传图片 "),a("input",{staticClass:"ipt-file",attrs:{type:"file"},on:{change:function(e){return t.fileChange(e)}}})])],1)])},i=[],r=(a("b680"),a("a9e3"),a("ac1f"),a("00b4"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"upload-container"},[a("el-button",{style:{background:t.color,borderColor:t.color},attrs:{icon:"el-icon-upload",size:"mini",type:"primary"},on:{click:function(e){t.dialogVisible=!0}}},[t._v(" upload ")]),a("el-dialog",{attrs:{visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("el-upload",{staticClass:"editor-slide-upload",attrs:{multiple:!0,"file-list":t.fileList,"show-file-list":!0,"on-remove":t.handleRemove,"on-success":t.handleSuccess,"before-upload":t.beforeUpload,action:"https://httpbin.org/post","list-type":"picture-card"}},[a("el-button",{attrs:{size:"small",type:"primary"}},[t._v(" Click upload ")])],1),a("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v(" Cancel ")]),a("el-button",{attrs:{type:"primary"},on:{click:t.handleSubmit}},[t._v(" Confirm ")])],1)],1)}),n=[],o=(a("d3b7"),a("b64b"),a("d81d"),a("3ca3"),a("ddb0"),a("2b3d"),a("9861"),{name:"EditorSlideUpload",props:{color:{type:String,default:"#1890ff"}},data:function(){return{dialogVisible:!1,listObj:{},fileList:[]}},methods:{checkAllSuccess:function(){var t=this;return Object.keys(this.listObj).every((function(e){return t.listObj[e].hasSuccess}))},handleSubmit:function(){var t=this,e=Object.keys(this.listObj).map((function(e){return t.listObj[e]}));this.checkAllSuccess()?(this.$emit("successCBK",e),this.listObj={},this.fileList=[],this.dialogVisible=!1):this.$message("Please wait for all images to be uploaded successfully. If there is a network problem, please refresh the page and upload again!")},handleSuccess:function(t,e){for(var a=e.uid,s=Object.keys(this.listObj),i=0,r=s.length;i<r;i++)if(this.listObj[s[i]].uid===a)return this.listObj[s[i]].url=t.files.file,void(this.listObj[s[i]].hasSuccess=!0)},handleRemove:function(t){for(var e=t.uid,a=Object.keys(this.listObj),s=0,i=a.length;s<i;s++)if(this.listObj[a[s]].uid===e)return void delete this.listObj[a[s]]},beforeUpload:function(t){var e=this,a=window.URL||window.webkitURL,s=t.uid;return this.listObj[s]={},new Promise((function(i,r){var n=new Image;n.src=a.createObjectURL(t),n.onload=function(){e.listObj[s]={hasSuccess:!1,uid:t.uid,width:this.width,height:this.height}},i(!0)}))}}}),l=o,c=(a("2332"),a("2877")),u=Object(c["a"])(l,r,n,!1,null,"8e4d474a",null),d=u.exports,m=["advlist anchor autolink autosave code codesample colorpicker colorpicker contextmenu directionality emoticons fullscreen hr image imagetools insertdatetime link lists media nonbreaking noneditable pagebreak paste preview print save searchreplace spellchecker tabfocus table template textcolor textpattern visualblocks visualchars wordcount"],p=m,f=["searchreplace bold italic underline strikethrough alignleft aligncenter alignright outdent indent  blockquote undo redo removeformat subscript superscript code codesample","hr bullist numlist link image charmap preview anchor pagebreak insertdatetime media table emoticons forecolor backcolor fullscreen"],b=f,h=a("b85c"),g=[];function v(){return window.tinymce}var k=function(t,e){var a=document.getElementById(t),s=e||function(){};if(!a){var i=document.createElement("script");i.src=t,i.id=t,document.body.appendChild(i),g.push(s);var r="onload"in i?n:o;r(i)}function n(e){e.onload=function(){this.onerror=this.onload=null;var t,a=Object(h["a"])(g);try{for(a.s();!(t=a.n()).done;){var s=t.value;s(null,e)}}catch(i){a.e(i)}finally{a.f()}g=null},e.onerror=function(){this.onerror=this.onload=null,s(new Error("Failed to load "+t),e)}}function o(t){t.onreadystatechange=function(){if("complete"===this.readyState||"loaded"===this.readyState){this.onreadystatechange=null;var e,a=Object(h["a"])(g);try{for(a.s();!(e=a.n()).done;){var s=e.value;s(null,t)}}catch(i){a.e(i)}finally{a.f()}g=null}}}a&&s&&(v()?s(null,a):g.push(s))},y=k,w=a("bc3a"),C=a.n(w),x=a("2f4d"),S=a("1b62"),j="https://cdn.jsdelivr.net/npm/tinymce-all-in-one@4.9.3/tinymce.min.js",_={name:"Tinymce",components:{editorImage:d,getToken:x["a"]},props:{id:{type:String,default:function(){return"vue-tinymce-"+ +new Date+(1e3*Math.random()).toFixed(0)}},value:{type:String,default:""},toolbar:{type:Array,required:!1,default:function(){return[]}},menubar:{type:String,default:"file edit insert view format table"},height:{type:[Number,String],required:!1,default:360},width:{type:[Number,String],required:!1,default:"auto"}},mixins:[S["a"]],data:function(){return{hasChange:!1,hasInit:!1,tinymceId:this.id,fullscreen:!1,languageTypeList:{en:"en",zh:"zh_CN",es:"es_MX",ja:"ja"}}},computed:{containerWidth:function(){var t=this.width;return/^[\d]+(\.[\d]+)?$/.test(t)?"".concat(t,"px"):t}},watch:{value:function(t){var e=this;!this.hasChange&&this.hasInit&&this.$nextTick((function(){return window.tinymce.get(e.tinymceId).setContent(t||"")}))}},mounted:function(){this.init()},activated:function(){window.tinymce&&this.initTinymce()},deactivated:function(){this.destroyTinymce()},destroyed:function(){this.destroyTinymce()},methods:{fileChange:function(t){var e=this,a=t.target.files,s=a[0],i=new FormData;i.append("file",s),C.a.post(this.uploadFileOss,i,{headers:this.token}).then((function(t){var a=t.data,s=a.success,i=a.data,r=a.message;s?e.imageSuccessCBK(i.material.ossUrl):e.$message.err(r)}))},init:function(){var t=this;y(j,(function(e){e?t.$message.error(e.message):t.initTinymce()}))},initTinymce:function(){var t=this,e=this;window.tinymce.init({selector:"#".concat(this.tinymceId),language:this.languageTypeList["zh"],height:this.height,body_class:"panel-body ",object_resizing:!1,toolbar:this.toolbar.length>0?this.toolbar:b,menubar:this.menubar,plugins:p,end_container_on_empty_block:!0,powerpaste_word_import:"clean",code_dialog_height:450,code_dialog_width:1e3,advlist_bullet_styles:"square",advlist_number_styles:"default",imagetools_cors_hosts:["www.tinymce.com","codepen.io"],default_link_target:"_blank",link_title:!1,nonbreaking_force_tab:!0,init_instance_callback:function(a){e.value&&a.setContent(e.value),e.hasInit=!0,a.on("NodeChange Change KeyUp SetContent",(function(){t.hasChange=!0,t.$emit("input",a.getContent())}))},setup:function(t){t.on("FullscreenStateChanged",(function(t){e.fullscreen=t.state}))},images_upload_handler:function(t,a,s,i){i(0);var r=new FormData;r.append("file",t.blob()),C.a.post(e.uploadFileOss,r,{headers:e.token}).then((function(t){var e=t.data,r=e.success,n=e.data,o=e.message;r?a(n.material.ossUrl):(s(o),i(100))}))},convert_urls:!1})},destroyTinymce:function(){var t=window.tinymce.get(this.tinymceId);this.fullscreen&&t.execCommand("mceFullScreen"),t&&t.destroy()},setContent:function(t){window.tinymce.get(this.tinymceId).setContent(t)},getContent:function(){window.tinymce.get(this.tinymceId).getContent()},imageSuccessCBK:function(t){window.tinymce.get(this.tinymceId).insertContent('<img class="wscnph" src="'.concat(t,'" >'))}}},O=_,I=(a("1539"),Object(c["a"])(O,s,i,!1,null,"4ba932b7",null));e["a"]=I.exports},a15b:function(t,e,a){"use strict";var s=a("23e7"),i=a("44ad"),r=a("fc6a"),n=a("a640"),o=[].join,l=i!=Object,c=n("join",",");s({target:"Array",proto:!0,forced:l||!c},{join:function(t){return o.call(r(this),void 0===t?",":t)}})},aab4:function(t,e,a){"use strict";a.d(e,"a",(function(){return i})),a.d(e,"b",(function(){return r}));var s=a("0c6d");function i(t){return Object(s["a"])({url:"/lejuAdmin/category/getAllCategory",method:"get",data:t})}function r(t){return Object(s["a"])({url:"/lejuAdmin/category/getAllCategory",method:"get",data:t})}},b191:function(t,e,a){"use strict";a.d(e,"c",(function(){return i})),a.d(e,"a",(function(){return r})),a.d(e,"d",(function(){return o})),a.d(e,"b",(function(){return n}));a("99af");var s=a("0c6d");function i(t,e,a){return Object(s["a"])({url:"/lejuAdmin/product/productsByPage/".concat(t,"/").concat(e),method:"post",data:a})}function r(t){return Object(s["a"])({url:"/lejuAdmin/product/addProductAndSkus",method:"post",data:t})}function n(t){return Object(s["a"])({url:"/lejuAdmin/product/productSkusDetail/".concat(t),method:"get"})}function o(t){return Object(s["a"])({url:"/lejuAdmin/product/updateProductAndSkus",method:"post",data:t})}},cdec:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.pageLoading,expression:"pageLoading"}],staticClass:"detail-main",attrs:{"element-loading-text":t.loadingOption.text,"element-loading-spinner":t.loadingOption.spinner,"element-loading-background":t.loadingOption.background}},[a("div",{staticClass:"step_main"},[a("el-steps",{staticClass:"step-bar",attrs:{active:t.step,"finish-status":"success"}},[a("el-step",{attrs:{title:"商品基本信息"}}),a("el-step",{attrs:{title:"添加库存信息"}}),a("el-step",{attrs:{title:"添加移动端详情"}})],1)],1),a("el-card",{staticClass:"box-card card",attrs:{shadow:"never"}},[a("div",{staticClass:"header"}),a("el-form",{ref:"form",staticClass:"form",attrs:{model:t.form,"label-width":"100px"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:1===t.step,expression:"step === 1"}]},[a("div",{staticClass:"form-section-head"},[t._v(" 基本信息 ")]),a("el-row",{attrs:{gutter:30}},[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{prop:"name",label:"商品名称",size:"small"}},[a("el-input",{staticClass:"myInput",model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{prop:"productSn",label:"商品编码",size:"small"}},[a("el-input",{staticClass:"myInput",model:{value:t.form.productSn,callback:function(e){t.$set(t.form,"productSn",e)},expression:"form.productSn"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{prop:"productCategoryId",label:"商品分类",size:"small"}},[a("el-select",{staticClass:"myInput",attrs:{placeholder:"商品分类",clearable:""},model:{value:t.form.productCategoryId,callback:function(e){t.$set(t.form,"productCategoryId",e)},expression:"form.productCategoryId"}},t._l(t.productCategoryList,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"商品品牌",size:"small",prop:"brandId"}},[a("el-select",{staticClass:"myInput",attrs:{clearable:"",placeholder:"品牌"},model:{value:t.form.brandId,callback:function(e){t.$set(t.form,"brandId",e)},expression:"form.brandId"}},t._l(t.brandList,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1)],1)],1),a("el-row",{attrs:{gutter:30}},[a("el-col",{attrs:{span:16,offset:0}},[a("el-form-item",{attrs:{label:"商品描述",size:"small"}},[a("el-input",{staticClass:"myInput",attrs:{type:"textarea",placeholder:"商品描述"},model:{value:t.form.description,callback:function(e){t.$set(t.form,"description",e)},expression:"form.description"}})],1)],1)],1),a("div",{staticClass:"form-section-head"},[t._v(" 商品属性 ")]),a("el-row",{attrs:{gutter:30}},[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"商品原价",size:"small",prop:"originalPrice"}},[a("el-input-number",{staticClass:"myInput",attrs:{placeholder:"商品原价"},on:{input:t.originalPriceChange},model:{value:t.form.originalPrice,callback:function(e){t.$set(t.form,"originalPrice",e)},expression:"form.originalPrice"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"促销类型",size:"small"}},[a("el-select",{staticClass:"myInput",attrs:{placeholder:"促销类型",clearable:"",disabled:""},model:{value:t.form.promotionType,callback:function(e){t.$set(t.form,"promotionType",e)},expression:"form.promotionType"}},t._l(t.promotionTypeList,(function(t,e){return a("el-option",{key:e,attrs:{label:t.name,value:t.id}})})),1)],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"活动价格",size:"small"}},[a("el-input-number",{staticClass:"myInput",attrs:{disabled:"",placeholder:"当前价格",type:"number"},model:{value:t.form.price,callback:function(e){t.$set(t.form,"price",e)},expression:"form.price"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"重量(kg)",size:"small",prop:"weight"}},[a("el-input-number",{staticClass:"myInput",attrs:{placeholder:"重量"},model:{value:t.form.weight,callback:function(e){t.$set(t.form,"weight",e)},expression:"form.weight"}})],1)],1)],1),a("el-row",{attrs:{gutter:30}},[a("el-col",{attrs:{span:8,offset:0}},[a("el-form-item",{attrs:{label:"审核状态",size:"small"}},[a("el-switch",{attrs:{"active-value":1,"inactive-value":0},model:{value:t.form.verifyStatus,callback:function(e){t.$set(t.form,"verifyStatus",e)},expression:"form.verifyStatus"}})],1)],1),a("el-col",{attrs:{span:8,offset:0}},[a("el-form-item",{attrs:{label:"是否上架",size:"small"}},[a("el-switch",{attrs:{"active-value":1,"inactive-value":0},model:{value:t.form.publishStatus,callback:function(e){t.$set(t.form,"publishStatus",e)},expression:"form.publishStatus"}})],1)],1)],1),a("el-row",{attrs:{gutter:30}},[a("el-form-item",{attrs:{label:"缩略图",size:"small",prop:"pic"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:t.uploadUrl,"show-file-list":!1,"on-success":t.handleAvatarSuccess}},[t.form.pic?a("img",{staticClass:"avatar",attrs:{src:t.form.pic}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1)],1),a("div",{staticClass:"form-section-head"},[t._v(" 其他信息 ")]),a("el-row",{attrs:{gutter:30}},[a("el-col",{attrs:{span:8,offset:0}},[a("el-form-item",{attrs:{label:"推荐状态",size:"small"}},[a("el-switch",{attrs:{"active-value":1,"inactive-value":0},model:{value:t.form.recommendStatus,callback:function(e){t.$set(t.form,"recommendStatus",e)},expression:"form.recommendStatus"}})],1)],1),a("el-col",{attrs:{span:8,offset:0}},[a("el-form-item",{attrs:{label:"新品状态",size:"small"}},[a("el-switch",{attrs:{"active-value":1,"inactive-value":0},model:{value:t.form.newStatus,callback:function(e){t.$set(t.form,"newStatus",e)},expression:"form.newStatus"}})],1)],1),a("el-col",{attrs:{span:8,offset:0}},[a("el-form-item",{attrs:{label:"预告商品",size:"small"}},[a("el-switch",{attrs:{"active-value":1,"inactive-value":0},model:{value:t.form.previewStatus,callback:function(e){t.$set(t.form,"previewStatus",e)},expression:"form.previewStatus"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"搜索关键词",size:"small","label-width":"100px"}},[a("el-input",{staticClass:"myInput",attrs:{placeholder:"关键词"},model:{value:t.form.keywords,callback:function(e){t.$set(t.form,"keywords",e)},expression:"form.keywords"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"库存预警",size:"small",prop:"lowStock"}},[a("el-input-number",{staticClass:"myInput",model:{value:t.form.lowStock,callback:function(e){t.$set(t.form,"lowStock",e)},expression:"form.lowStock"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"商品排序",size:"small",prop:"sort"}},[a("el-input-number",{staticClass:"myInput",attrs:{placeholder:"排序"},model:{value:t.form.sort,callback:function(e){t.$set(t.form,"sort",e)},expression:"form.sort"}})],1)],1),a("el-col",{attrs:{span:16,offset:0}},[a("el-form-item",{attrs:{label:"产品服务",size:"small"}},[a("el-checkbox-group",{model:{value:t.serviceIds,callback:function(e){t.serviceIds=e},expression:"serviceIds"}},[a("el-checkbox",{attrs:{label:"1",name:"type"}},[t._v("无忧退货")]),a("el-checkbox",{attrs:{label:"2",name:"type"}},[t._v("快速退款")]),a("el-checkbox",{attrs:{label:"3",name:"type"}},[t._v("免费包邮")])],1)],1)],1)],1)],1),a("div",{directives:[{name:"show",rawName:"v-show",value:2===t.step,expression:"step === 2"}]},[a("div",{staticClass:"form-section-head"},[t._v(" 商品sku信息 ")]),a("el-row",{attrs:{gutter:30}},[a("el-col",{attrs:{span:8,offset:0}},[a("el-form-item",{attrs:{label:"标题",size:"small",prop:"detailTitle"}},[a("el-input",{attrs:{placeholder:"标题"},model:{value:t.form.detailTitle,callback:function(e){t.$set(t.form,"detailTitle",e)},expression:"form.detailTitle"}})],1)],1),a("el-col",{attrs:{span:12,offset:0}},[a("el-form-item",{attrs:{label:"副标题",size:"small",prop:"detailDesc"}},[a("el-input",{attrs:{placeholder:"副标题"},model:{value:t.form.detailDesc,callback:function(e){t.$set(t.form,"detailDesc",e)},expression:"form.detailDesc"}})],1)],1)],1),a("el-form-item",{staticClass:"albumPics",attrs:{label:"画册图片",size:"small"}},[a("el-upload",{attrs:{action:t.uploadUrl,"on-remove":t.handleRemove,"file-list":t.fileList,"on-success":t.imgUploadSuccess,limit:5,"on-preview":t.handlePictureCardPreview,"list-type":"picture-card"}},[a("i",{staticClass:"el-icon-plus"}),a("el-dialog",{attrs:{visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("img",{attrs:{width:"100%",src:t.dialogImageUrl,alt:""}})]),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v(" 只能上传jpg/png文件，且不超过500kb,文件不超过5个 ")])],1)],1),a("el-form-item",{staticStyle:{"margin-top":"10px"},attrs:{label:"sku设置"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.skuColorList.length>0,expression:"skuColorList.length > 0"}],staticStyle:{display:"flex"}},[t._v(" 颜色： "),a("el-checkbox-group",{model:{value:t.skuColorSel,callback:function(e){t.skuColorSel=e},expression:"skuColorSel"}},t._l(t.skuColorList,(function(e,s){return a("el-checkbox",{key:s,attrs:{label:e}},[a("span",[t._v(t._s(e.text))]),a("el-button",{staticStyle:{color:"red","margin-left":"10px"},attrs:{size:"mini",type:"text"},on:{click:function(a){return t.delParam(e,"skuColorList","skuColorSel")}}},[t._v("删除")])],1)})),1)],1),a("div",{directives:[{name:"show",rawName:"v-show",value:t.skuCapacityList.length>0,expression:"skuCapacityList.length > 0"}],staticStyle:{display:"flex"}},[t._v(" 大小： "),a("el-checkbox-group",{model:{value:t.skuCapacitySel,callback:function(e){t.skuCapacitySel=e},expression:"skuCapacitySel"}},t._l(t.skuCapacityList,(function(e,s){return a("el-checkbox",{key:s,attrs:{label:e}},[a("span",[t._v(t._s(e.text))]),a("el-button",{staticStyle:{color:"red","margin-left":"10px"},attrs:{size:"mini",type:"text"},on:{click:function(a){return t.delParam(e,"skuCapacityList","skuCapacitySel")}}},[t._v("删除")])],1)})),1)],1),a("div",{staticClass:"sku_flex"},[a("div",[a("el-input",{staticClass:"sku_flex_item",staticStyle:{width:"180px"},attrs:{size:"small",placeholder:"颜色描述：比如土豪金"},model:{value:t.skuColorObj.text,callback:function(e){t.$set(t.skuColorObj,"text",e)},expression:"skuColorObj.text"}}),a("el-button",{staticClass:"sku_flex_item",attrs:{size:"small"},on:{click:function(e){return t.addSkuObj("skuColorObj","skuColorList")}}},[t._v("创建颜色选项")])],1),a("div",[a("el-input",{staticClass:"sku_flex_item",staticStyle:{width:"180px"},attrs:{size:"small",placeholder:"大小"},model:{value:t.skuCapacityObj.text,callback:function(e){t.$set(t.skuCapacityObj,"text",e)},expression:"skuCapacityObj.text"}}),a("el-button",{staticClass:"sku_flex_item",attrs:{size:"small"},on:{click:function(e){return t.addSkuObj("skuCapacityObj","skuCapacityList")}}},[t._v("创建大小选项 ")])],1),a("div",{staticStyle:{"margin-left":"200px"}},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.createSkus}},[t._v("生成sku列表")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.createSkus("add")}}},[t._v("新增sku")])],1)]),a("div",{staticClass:"sku_table"},[a("el-table",{directives:[{name:"show",rawName:"v-show",value:t.skuList.length>0,expression:"skuList.length > 0"}],attrs:{size:"mini",data:t.skuList,border:"",stripe:""}},[a("el-table-column",{attrs:{type:"index",label:"#",fixed:"left"}}),a("el-table-column",{attrs:{label:"图片",width:120},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-upload",{staticStyle:{width:"100px",height:"100px"},attrs:{action:t.uploadUrl,"show-file-list":!1,"on-success":t.handleTableSuccess},nativeOn:{click:function(a){return t.getTableItem(e.row)}}},[e.row.pic?a("img",{staticClass:"avatar",staticStyle:{width:"100px",height:"100px"},attrs:{src:e.row.pic}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon",staticStyle:{width:"100px",height:"100px","margin-top":"-31px"}})])]}}])}),a("el-table-column",{attrs:{label:"颜色",width:160},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{attrs:{size:"mini"},model:{value:e.row.spData[0].value,callback:function(a){t.$set(e.row.spData[0],"value",a)},expression:"scope.row.spData[0].value"}})]}}])}),a("el-table-column",{attrs:{label:"大小",width:160},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.spData[1]?a("el-input",{attrs:{size:"mini"},model:{value:e.row.spData[1].value,callback:function(a){t.$set(e.row.spData[1],"value",a)},expression:"scope.row.spData[1].value"}}):t._e()]}}])}),a("el-table-column",{attrs:{label:"库存",width:200},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{attrs:{size:"mini",placeholder:"自定义库存"},model:{value:e.row.stock,callback:function(a){t.$set(e.row,"stock",a)},expression:"scope.row.stock"}})]}}])}),a("el-table-column",{attrs:{label:"预警库存",width:200},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{attrs:{size:"mini",placeholder:"预警库存"},model:{value:e.row.lowStock,callback:function(a){t.$set(e.row,"lowStock",a)},expression:"scope.row.lowStock"}})]}}])}),a("el-table-column",{attrs:{label:"锁定库存",width:200},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{attrs:{size:"mini",placeholder:"锁定库存"},model:{value:e.row.lockStock,callback:function(a){t.$set(e.row,"lockStock",a)},expression:"scope.row.lockStock"}})]}}])}),a("el-table-column",{attrs:{label:"sku编码",width:200},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{attrs:{size:"mini",placeholder:"自定义sku编码"},model:{value:e.row.skuCode,callback:function(a){t.$set(e.row,"skuCode",a)},expression:"scope.row.skuCode"}})]}}])}),a("el-table-column",{attrs:{label:"价格",width:160},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{attrs:{size:"mini",placeholder:"价格,单位:分"},model:{value:e.row.price,callback:function(a){t.$set(e.row,"price",a)},expression:"scope.row.price"}})]}}])}),a("el-table-column",{attrs:{label:"销量",width:160},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{attrs:{size:"mini"},model:{value:e.row.sale,callback:function(a){t.$set(e.row,"sale",a)},expression:"scope.row.sale"}})]}}])}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:160},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{staticStyle:{color:"red"},attrs:{size:"mini",type:"text"},on:{click:function(a){return t.removeSku(e.row)}}},[t._v("删除")])]}}])})],1)],1)])],1),a("div",{directives:[{name:"show",rawName:"v-show",value:3===t.step,expression:"step === 3"}]},[a("div",{staticClass:"form-section-head"},[t._v(" 详情描述 ")]),a("el-form-item",{attrs:{size:"small",label:"商品详情"}},[a("TinEditor",{ref:"tin"})],1),a("el-form-item",{attrs:{label:"备注",size:"small"}},[a("el-input",{staticClass:"myInput",attrs:{type:"textarea",placeholder:"备注"},model:{value:t.form.note,callback:function(e){t.$set(t.form,"note",e)},expression:"form.note"}})],1)],1),a("div",{staticClass:"bottom_main"},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.step>1,expression:"step > 1"}],staticClass:"submit_button",attrs:{size:"small"},on:{click:t.preBtn}},[t._v("返回上一步 ")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.step<3,expression:"step < 3"}],staticClass:"submit_button",attrs:{size:"small",type:"primary"},on:{click:t.nextBtn}},[t._v(t._s(t.nextBtnText)+" ")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:3==t.step,expression:"step == 3"}],staticClass:"submit_button",attrs:{size:"small",type:"primary",loading:t.couldNext},on:{click:t.onSubmit}},[t._v("提交保存")])],1)])],1)],1)},i=[],r=a("5530"),n=a("c7eb"),o=a("1da1"),l=(a("d3b7"),a("159b"),a("b0c0"),a("4de4"),a("e9c4"),a("d81d"),a("a15b"),a("aab4")),c=a("1b62"),u=a("782b"),d=a("b191"),m=a("8256"),p={name:"AddGoods",components:{TinEditor:m["a"]},mixins:[c["a"]],data:function(){return{pageLoading:!1,couldNext:!1,step:1,id:"",skuList:[],tempSkuList:[],tempTableObj:{},skuParamsList:[],skuColorObj:{},skuColorList:[],skuColorSel:[],skuCapacityObj:{},skuCapacityList:[],skuCapacitySel:[],brandList:[],productCategoryList:[],promotionTypeList:[{name:"没有促销使用原价",id:0},{name:"使用促销价",id:1},{name:"使用会员价",id:2},{name:"使用阶梯价格",id:3},{name:"使用满减价格",id:4},{name:"限时购",id:5}],form:{productSn:"",name:"",brandId:"",price:"",originalPrice:"",sort:"",keywords:"",description:"",note:"",deleteStatus:"0",newStatus:"0",previewStatus:"0",publishStatus:"0",recommendStatus:"1",verifyStatus:"1",weight:"",detailTitle:"",detailDesc:"",pic:"",lowStock:"",productAttributeCategoryId:"",productCategoryId:"",promotionType:0},dialogImageUrl:"",dialogVisible:!1,serviceIds:[],imgList:[],firstPageValidFiles:["name","productSn","productCategoryId","brandId","originalPrice","weight","pic","lowStock","sort"],secondPageValidFiles:["detailTitle","detailDesc"],rules:{name:[{required:!0,message:"请输入活动名称",trigger:"blur"}],productSn:[{required:!0,message:"请输入商品编码",trigger:"blur"}],productCategoryId:[{required:!0,message:"请选择商品分类",trigger:"change"}],brandId:[{required:!0,message:"请选择商品品牌",trigger:"change"}],originalPrice:[{required:!0,pattern:/1/,message:"商品原价要求为大于 0 的数",trigger:"blur",transform:function(t){return t>0?"1":"0"}}],weight:[{required:!0,pattern:/1/,message:"商品重量要求为大于 0 的数",transform:function(t){return t>0?"1":"0"},trigger:"blur"}],pic:[{required:!0,message:"请上传缩略图"}],lowStock:[{required:!0,pattern:/1/,message:"库存预警要求为大于 0 的数",transform:function(t){return t>0?"1":"0"},trigger:"blur"}],sort:[{required:!0,pattern:/1/,message:"商品排序要求为大于 0 的数",transform:function(t){return t>0?"1":"0"},trigger:"blur"}],detailTitle:[{required:!0,message:"请填写标题",trigger:"blur"}],detailDesc:[{required:!0,message:"请填写副标题",trigger:"blur"}]}}},computed:{nextBtnText:function(){var t="";switch(this.step){case 1:t="下一步,填写库存信息";break;case 2:t="下一步,填写移动端详情";break;default:break}return t}},created:function(){var t=this;return Object(o["a"])(Object(n["a"])().mark((function e(){return Object(n["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.id=t.$route.params.id,e.next=3,t.getCategory1();case 3:return e.next=5,t.getBrandList();case 5:t.id&&t.getDetail();case 6:case"end":return e.stop()}}),e)})))()},methods:{originalPriceChange:function(t){this.form.price=t},getTableItem:function(t){this.tempTableObj=t},getDetail:function(){var t=this;this.pageLoading=!0,Object(d["b"])(this.id).then((function(e){if(t.form=e.data.product,e.data.skus.forEach((function(e){t.skuList.push(Object(r["a"])(Object(r["a"])({},e),{},{spData:JSON.parse(e.spData)})),t.tempSkuList.push(Object(r["a"])(Object(r["a"])({},e),{},{spData:JSON.parse(e.spData)}))})),t.form.albumPics){var a=t.form.albumPics.split(",");a.forEach((function(e){t.fileList.push({url:e})}))}t.form.serviceIds&&t.form.serviceIds.length>0&&(t.serviceIds=t.form.serviceIds.split(",")),t.setTin(t.form.detailMobileHtml),t.pageLoading=!1})).catch((function(e){t.$message.error(e),t.pageLoading=!1}))},getCategory1:function(){var t=this;Object(l["b"])().then((function(e){console.log(e),e.success&&e.data.items.forEach((function(e){"乐居"===e.category.name&&(t.productCategoryList=e.children)}))})).catch((function(t){console.log(t)}))},createSkus:function(t){var e=this;return Object(o["a"])(Object(n["a"])().mark((function a(){var s;return Object(n["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!(e.skuColorSel.length<=0)){a.next=3;break}return e.$message.error("请选中颜色"),a.abrupt("return");case 3:if(s={pic:"",price:e.form.price,sale:"",skuCode:"100000",stock:"",lowStock:""},"add"===t){a.next=7;break}return a.next=7,e.$confirm("此操作将清空sku列表,并生成新的列表, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.skuList=[],e.$message({type:"success",message:"创建成功!"})}));case 7:e.skuCapacitySel.length>0?e.skuColorSel.forEach((function(t){e.skuCapacitySel.forEach((function(a){var i=[{key:"颜色",value:t.text},{key:"大小",value:a.text}];e.skuList.push(Object(r["a"])({spData:i,tempId:""},s))}))})):e.skuColorSel.forEach((function(t){var a=[{key:"颜色",value:t.text}];e.skuList.push(Object(r["a"])({spData:a,tempId:""},s))}));case 8:case"end":return a.stop()}}),a)})))()},removeSku:function(t){t.tempId?this.skuList=this.skuList.filter((function(e){return e.tempId!=t.tempId})):this.skuList=this.skuList.filter((function(e){return e.id!=t.id}))},delParam:function(t,e,a){this[a]=this[a].filter((function(e){return e.tempId!=t.tempId})),this[e]=this[e].filter((function(e){return e.tempId!=t.tempId}))},addSkuObj:function(t,e){var a=Object.assign({tempId:""},this[t]);this[e].push(a),this[t]={}},handleAvatarSuccess:function(t){this.form.pic=t.data.fileUrl},handleTableSuccess:function(t){var e=this;this.skuList.forEach((function(a){a===e.tempTableObj&&(a.pic=t.data.fileUrl)}))},handleRemove:function(t){this.fileList=this.fileList.filter((function(e){return e.url!=t.url}))},handlePictureCardPreview:function(t){this.dialogImageUrl=t.url,this.dialogVisible=!0},imgUploadSuccess:function(t){t.success?(this.fileList.push({url:t.data.fileUrl}),this.$message.success("上传成功")):this.$message.error("上传失败")},getBrandList:function(){var t=this;Object(u["b"])().then((function(e){console.log(e),t.brandList=e.data.items})).catch((function(t){console.log("error",t)}))},onSubmit:function(){var t=this,e="",a="";this.brandList.forEach((function(a){a.id===t.form.brandId&&(e=a.name)})),this.productCategoryList.forEach((function(e){e.id===t.form.productCategoryId&&(a=e.name)})),this.$refs.form.validate((function(s){if(!s)return t.$message.error("请填写必要信息"),!1;t.couldNext=!0;var i=t.getTin(),n=[];t.skuList.forEach((function(t){t.tempId&&delete t.tempId,n.push(Object(r["a"])(Object(r["a"])({},t),{},{spData:JSON.stringify(t.spData)}))}));var o=t.fileList.map((function(t){return t.url}));t.id?Object(d["d"])({pmsSkuStockList:n,product:Object(r["a"])(Object(r["a"])({},t.form),{},{brandName:e,productCategoryName:a,detailMobileHtml:i,albumPics:o.join(","),serviceIds:t.serviceIds.join(",")})}).then((function(e){e.success&&(t.$message.success("修改成功"),t.$router.push({path:"/product/list"})),t.couldNext=!1})).catch((function(e){console.log(e),t.couldNext=!1,t.$message.error("添加失败")})):Object(d["a"])({pmsSkuStockList:n,product:Object(r["a"])(Object(r["a"])({},t.form),{},{brandName:e,productCategoryName:a,detailMobileHtml:i,albumPics:o.join(","),serviceIds:t.serviceIds.join(",")})}).then((function(e){e.success&&(t.$message.success("新增成功"),t.$router.push({path:"/product/list"})),t.couldNext=!1})).catch((function(e){t.couldNext=!1,console.log(e),t.$message.error("添加失败")}))}))},nextBtn:function(){var t=!0,e=[];1==this.step?e=this.firstPageValidFiles:2==this.step&&(e=this.secondPageValidFiles),this.$refs.form.validateField(e,(function(e){t=e?t&&!1:t&&!0})),t?this.step++:this.$message.error("请注意表单验证！！！")},preBtn:function(){this.step--},getTin:function(){var t=this.$refs.tin.getContent();return t},setTin:function(t){this.$refs.tin.setDelayContent(t)}}},f=p,b=(a("41e5"),a("2877")),h=Object(b["a"])(f,s,i,!1,null,"3ebcf065",null);e["default"]=h.exports}}]);