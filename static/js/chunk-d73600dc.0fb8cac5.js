(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d73600dc"],{"0c6d":function(e,t,r){"use strict";r("d3b7");var n=r("bc3a"),a=r.n(n),s=r("5c96"),o=r("4360"),i=r("2f4d"),l=void 0,c=a.a.create({baseURL:"http://leju.bufan.cloud",timeout:5e3});c.interceptors.request.use((function(e){return Object(i["a"])()&&(e.headers["token"]=Object(i["a"])()),e}),(function(e){return console.log(e),Promise.reject(e)})),c.interceptors.response.use((function(e){var t=e.data;return 2e4!==t.code?(Object(s["Message"])({message:t.message||"Error",type:"error",duration:5e3}),20002===t.code&&(Object(i["c"])(),Object(i["d"])(),l.$router.push("/login")),50008!==t.code&&50012!==t.code&&50014!==t.code||s["MessageBox"].confirm("You have been logged out, you can cancel to stay on this page, or log in again","Confirm logout",{confirmButtonText:"Re-Login",cancelButtonText:"Cancel",type:"warning"}).then((function(){o["a"].dispatch("user/resetToken").then((function(){location.reload()}))})),Promise.reject(new Error(t.message||"Error"))):t}),(function(e){return console.log("err"+e),Object(s["Message"])({message:e.message,type:"error",duration:5e3}),Promise.reject(e)})),t["a"]=c},"1b62":function(e,t,r){"use strict";var n=r("2f4d");t["a"]={data:function(){return{uploadFileOss:"/lejuAdmin/material/uploadFileOssSave",uploadUrl1:"/lejuAdmin/material/uploadFileOss",uploadUrl:"/lejuAdmin/material/uploadFileOssSave",uploadHeaders:{token:Object(n["a"])()},pagniationParams:{start:1,limit:10,totalNum:0,pageSizes:[10,20,30,40]},loadingOption:{background:"rgba(255,255,255,.9)",text:"loading.....",spinner:"el-icon-loading"}}},computed:{token:function(){return{token:Object(n["a"])()}}}}},"464a":function(e,t,r){},a78c:function(e,t,r){"use strict";r("464a")},b6df:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"c",(function(){return s})),r.d(t,"f",(function(){return o})),r.d(t,"h",(function(){return i})),r.d(t,"i",(function(){return l})),r.d(t,"b",(function(){return c})),r.d(t,"e",(function(){return u})),r.d(t,"d",(function(){return d})),r.d(t,"g",(function(){return m}));r("99af");var n=r("0c6d");function a(){return Object(n["a"])({url:"/admin/sysAuth/permission/findAllPermissions",method:"get"})}function s(e,t,r){return Object(n["a"])({url:"/admin/sysAuth/role/findRolesByPage/".concat(e,"/").concat(t),method:"get",data:r})}function o(e){return Object(n["a"])({url:"/admin/sysAuth/role/removeRole/".concat(e),method:"delete"})}function i(e){return Object(n["a"])({url:"/admin/sysAuth/role/saveRolePermissions",method:"POST",data:e})}function l(e){return Object(n["a"])({url:"/admin/sysAuth/role/updateRolePermissions",method:"PUT",data:e})}function c(){return Object(n["a"])({url:"/admin/sysAuth/role/findAllRoles",method:"GET"})}function u(e){return Object(n["a"])({url:"/admin/sysAuth/role/findRolePermissions/".concat(e),method:"get"})}function d(e,t,r){return Object(n["a"])({url:"/admin/sysAuth/user/findUsersByPage/".concat(e,"/").concat(t),method:"POST",data:r})}function m(e){return Object(n["a"])({url:"/admin/sysAuth/user/removeUser/".concat(e),method:"DELETE"})}},d532:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"role-main"},[r("el-card",{staticClass:"margin-30",attrs:{shadow:"never"}},[r("div",{attrs:{slot:"header"},slot:"header"},[r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.goAdd}},[e._v("新增角色")])],1),r("el-table",{staticStyle:{width:"100%"},attrs:{data:e.roleList,border:"",stripe:""}},[r("el-table-column",{attrs:{type:"index",label:"#",width:"60",fixed:""}}),r("el-table-column",{attrs:{prop:"roleName",label:"角色名称",fixed:""}}),r("el-table-column",{attrs:{prop:"roleCode",label:"角色编码"}}),r("el-table-column",{attrs:{prop:"remark",label:"备注"}}),r("el-table-column",{attrs:{prop:"createTime",label:"添加时间"}}),r("el-table-column",{attrs:{fixed:"right",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"success",size:"small"},on:{click:function(r){return e.goEdit(t.row.id)}}},[e._v("编辑")]),r("el-button",{attrs:{size:"small"},on:{click:function(r){return e.goDel(t.row.id)}}},[e._v("删除")])]}}])})],1),r("el-pagination",{staticStyle:{"margin-top":"10px","text-align":"right"},attrs:{"page-size":e.pagniationParams.limit,total:e.pagniationParams.totalNum,layout:"total, sizes, prev, pager, next, jumper","page-sizes":e.pagniationParams.pageSizes,"current-page":e.pagniationParams.start},on:{"update:currentPage":function(t){return e.$set(e.pagniationParams,"start",t)},"update:current-page":function(t){return e.$set(e.pagniationParams,"start",t)},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),r("RoleForm",{ref:"roleForm",attrs:{menuList:e.menuList},on:{refresh:e.findRolesByPage,getAllMenu:e.getAllMenuList}})],1)},a=[],s=r("b6df"),o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"role-form"},[r("el-dialog",{attrs:{title:"编辑角色",visible:e.dialog,width:"30%"},on:{"update:visible":function(t){e.dialog=t},close:e.handleClose}},[r("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"80px",inline:!1,size:"normal"}},[r("el-form-item",{attrs:{label:"角色名称",prop:"roleName"}},[r("el-input",{attrs:{size:"small"},model:{value:e.form.roleName,callback:function(t){e.$set(e.form,"roleName",t)},expression:"form.roleName"}})],1),r("el-form-item",{attrs:{label:"角色编码",prop:"roleCode"}},[r("el-input",{attrs:{size:"small"},model:{value:e.form.roleCode,callback:function(t){e.$set(e.form,"roleCode",t)},expression:"form.roleCode"}})],1),r("el-form-item",{attrs:{label:"角色描述",prop:"remark"}},[r("el-input",{attrs:{type:"textarea",size:"small"},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1),r("el-form-item",{attrs:{label:"选择菜单"}},[r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:6,offset:0}},[r("el-checkbox",{attrs:{indeterminate:!1},on:{change:e.handelExpand},model:{value:e.isExpand,callback:function(t){e.isExpand=t},expression:"isExpand"}},[e._v("展开/关闭")])],1),r("el-col",{attrs:{span:6,offset:0}},[r("el-checkbox",{attrs:{indeterminate:!1},on:{change:e.handleSelectAll},model:{value:e.isSelectAll,callback:function(t){e.isSelectAll=t},expression:"isSelectAll"}},[e._v("全选/取消权限")])],1)],1),r("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:e.treeLoad,expression:"treeLoad"}],ref:"tree",attrs:{"node-key":"id","show-checkbox":"",data:e.menuList,props:e.defaultProps}})],1)],1),r("span",{attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{size:"small"},on:{click:e.handleClose}},[e._v("取消")]),r("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.doSave}},[e._v("确定")])],1)],1)],1)},i=[],l=r("5530"),c={name:"AuthUser",props:{menuList:{type:Array,required:!0}},data:function(){return{treeLoad:!1,dialog:!1,isExpand:!1,isSelectAll:!1,defaultProps:{label:"title",children:"children"},form:{},rules:{roleName:[{required:!0,message:"角色名称不能为空",trigger:"blur"}],menuIds:[]},selectKeys:[]}},created:function(){},methods:{openDialog:function(e){var t=this;this.dialog=!0,e&&(this.treeLoad=!0,Object(s["e"])(e).then((function(e){e.success?(e.data.role.permissionIds&&(t.$refs.tree.setCheckedKeys(e.data.role.permissionIds),delete e.data.role.permissionIds),t.form=e.data.role):t.$message.error("查询失败!"),t.treeLoad=!1})))},handleClose:function(){this.dialog=!1,this.$refs.form.resetFields(),this.$refs.tree.setCheckedKeys([])},doSave:function(){var e=this;this.$refs.form.validate((function(t){if(!t)return e.$message.error("请注意表单验证!"),!1;var r=null,n=Object(l["a"])(Object(l["a"])({},e.form),{},{permissionIds:e.$refs.tree.getCheckedKeys()});r=n.id?s["i"]:s["h"],r(n).then((function(t){if(!t.success)return e.$message.error("保存失败!"),!1;e.$message.success("保存成功!"),e.handleClose(),e.$emit("refresh")}))}))},handelExpand:function(e){this.setAllExpand(e)},setAllExpand:function(e){var t=this.$refs.tree.store.nodesMap;for(var r in t)t[r].expanded=e},handleSelectAll:function(e){e?(this.seltAllSelect(this.menuList),this.$refs.tree.setCheckedKeys(this.selectKeys)):this.$refs.tree.setCheckedKeys([])},seltAllSelect:function(e){for(var t=0;t<e.length;t++){var r=e[t];this.selectKeys.push(r.id),r.children&&r.children.length>0&&this.seltAllSelect(r.children)}}}},u=c,d=r("2877"),m=Object(d["a"])(u,o,i,!1,null,"1541daac",null),f=m.exports,h=r("1b62"),p={name:"Roles",mixins:[h["a"]],data:function(){return{search:{username:"abc"},roleList:[],menuList:[]}},components:{RoleForm:f},computed:{},created:function(){this.findRolesByPage(),this.getAllMenuList()},methods:{getAllMenuList:function(){var e=this;Object(s["a"])().then((function(t){t.success?(console.log(t.data.menus),e.menuList=t.data.menus):e.$message.error("获取数据失败!"),e.loading=!1}))},findRolesByPage:function(){var e=this;Object(s["c"])(this.pagniationParams.start,this.pagniationParams.limit).then((function(t){console.log(t);var r=t.success,n=t.data,a=t.message;if(r){var s=n.rows,o=n.total;e.roleList=s,e.pagniationParams.totalNum=o}else e.$message.error(a)}))},handleSizeChange:function(e){this.limit=e,this.start=1,this.getArticleList()},handleCurrentChange:function(e){this.start=e,this.getArticleList()},goAdd:function(){this.$refs.roleForm.openDialog()},goEdit:function(e){this.$refs.roleForm.openDialog(e)},goDel:function(e){var t=this;this.$confirm("此操作将永久删除该角色, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(s["f"])(e).then((function(e){var r=e.success,n=e.message;r?(t.$message.success(n),t.findRolesByPage()):t.$message.error(n)}))})).catch((function(){}))}}},g=p,b=(r("a78c"),Object(d["a"])(g,n,a,!1,null,"b792534e",null));t["default"]=b.exports}}]);